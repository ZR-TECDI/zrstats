{% extends 'stats/base.html' %}
{% load static %}

{% block head_extra %}
<!-- DATATABLES -->
<link rel="stylesheet" href="{% static 'stats/datatables/datatables.min.css'%}"/>
{% endblock %}

{% block head_title %}
    Asist. {{ fecha_mes|date:"F Y" }}
{% endblock %}

{% block breadcrumbs %}
<ol class="breadcrumbs">
    <li>
        <a href="{% url 'stats:index' %}">
            <i class="fa fa-home"></i>
        </a>
    </li>
    <li><span>Misiones</span></li>
</ol>
{% endblock %}

{% block titulo_pagina %}
    Misiones de {{ fecha_mes|date:"F" }}
{% endblock %}


{% block content %}
<section class="panel">
    <header class="panel-heading">
    <div class="panel-actions">
    </div>
    <h2 class="panel-title">Tabla de Asistencia Mensual [{{ fecha_mes|date:"F Y" }}]
        <span class="pull-right text-muted">Referencia:
            <span class="badge alert-danger">Misi√≥n Oficial</span>
            <span class="badge alert-info">Curso</span>
            <span class="badge alert-success">Impro</span>
            <span class="badge alert-warning">Otros</span>
        </span>
    </h2>

    </header>
    <div class="panel-body">
        <table class="table table-condensed table-bordered" id="datatable-tabletools" data-swf-path="{% static 'stats/octopus/assets/vendor/jquery-datatables/extras/TableTools/swf/copy_csv_xls_pdf.swf'%}">
            <thead>
            <th style="width: 4%">Miembro</th>
            {% for mision in misiones_mes %}
                {% if mision.tipo == "CAMPANA" or mision.tipo == "ENTRENAMIENTO" or mision.tipo == "GALA"  %}
                    <th class="text-center alert-danger" data-toggle="tooltip" data-placement="top" data-original-title="{{ mision }} ({{ mision.fecha_finalizada|date:"l" }})">
                       <a href="{% url 'stats:mision_detail' mision.id %}">{{ mision.fecha_finalizada|date:"D d"}}</a>
                    </th>
                {% elif  mision.tipo == "IMPROVISADA"%}
                    <th class="text-center alert-success" data-toggle="tooltip" data-placement="top" data-original-title="{{ mision }} ({{ mision.fecha_finalizada|date:"l" }})">
                       <a href="{% url 'stats:mision_detail' mision.id %}">{{ mision.fecha_finalizada|date:"D d"}}</a>
                    </th>
                {% elif  mision.tipo == "CURSO"%}
                    <th class="text-center alert-info" data-toggle="tooltip" data-placement="top" data-original-title="{{ mision }} ({{ mision.fecha_finalizada|date:"l" }})">
                       <a href="{% url 'stats:mision_detail' mision.id %}">{{ mision.fecha_finalizada|date:"D d"}}</a>
                    </th>
                {% else  %}
                    <th class="text-center alert-warning" data-toggle="tooltip" data-placement="top" data-original-title="{{ mision }} ({{ mision.fecha_finalizada|date:"l" }})">
                       <a href="{% url 'stats:mision_detail' mision.id %}">{{ mision.fecha_finalizada|date:"D d"}}</a>
                    </th>
                {% endif %}
            {% endfor %}
            </thead>
            {% for m in asistencia %}
                <tr>
                <td><a href="{{ m.miembro.get_absolute_url }}">{{ m.miembro }}</a></td>
                {% for r in m.asistencia %}

                    {% if r.asistencia == "FALTA" %}
                       <td class="danger text-center">
                           <a href="{{ r.get_absolute_url }}" style="text-decoration:none">
                               <span class="input-group-addon btn-danger">F</span>
                           </a>
                       </td>
                    {% elif r.asistencia == "ASISTE" %}
                        <td class="success text-center">
                            <a href="{{ r.get_absolute_url }}" style="text-decoration:none">
                               <span class="input-group-addon btn-success">A</span>
                           </a>
                        </td>
                    {% elif r.asistencia == "TARDE" %}
                        <td class="warning text-center">
                            <a href="{{ r.get_absolute_url }}" style="text-decoration:none">
                               <span class="input-group-addon btn-warning">T</span>
                           </a>
                        </td>
                    {% else %}
                        <td>{{ r.asistencia }}</td>
                    {% endif %}

                {% endfor %}

                </tr>
                {% endfor %}
            </table>
        </div>
        <div class="row datatables-footer"></div>
    </div>
</section>

{% endblock %}
{% block extra_scripts %}

<!-- DATATABLES -->
<script src="{% static 'stats/datatables/datatables.min.js'%}"></script>
<script src="{% static 'stats/datatables/dataTables.bootstrap.min.js'%}"></script>

<script>
(function( $ ) {

	'use strict';

	var datatableInit = function() {
		var $table = $('#datatable-tabletools');

		$table.dataTable({
            ordering: false,
            pageLength: 50,
			sDom: "B<'text-right mb-md'T>" + $.fn.dataTable.defaults.sDom,
			oTableTools: {
				sSwfPath: $table.data('swf-path'),
				aButtons: [
					{
						sExtends: 'pdf',
						sButtonText: 'PDF'
					},
					{
						sExtends: 'csv',
						sButtonText: 'CSV'
					},
					{
						sExtends: 'xls',
						sButtonText: 'Excel'
					},
					{
						sExtends: 'print',
						sButtonText: 'Print',
						sInfo: 'Please press CTR+P to print or ESC to quit'
					}
				]
			}
		});

	};

	$(function() {
		datatableInit();
	});

}).apply( this, [ jQuery ]);

</script>
{% endblock %}
{% extends "stats/base.html" %}
{% load static %}

{% block head_title %}
    Misión
{% endblock %}

{% block breadcrumbs %}
<ol class="breadcrumbs">
    <li>
        <a href="{% url 'stats:index' %}">
            <i class="fa fa-home"></i>
        </a>
    </li>
    <li><span>CRUDs</span></li>
    <li><span>Misión</span></li>
</ol>
{% endblock %}

{% block titulo_pagina %}
    Misión
{% endblock %}


{% block content %}

<div class="row">
    <ul>
        <li class="btn btn-default"><a href="#" class="all">Todas</a></li>
        <li class="btn btn-default"><a  href="#">Campaña</a></li>
        <li class="btn btn-default"><a href="#">Improvisada</a></li>
        <li class="btn btn-default"><a href="#}">Curso</a></li>
        <li class="btn btn-default"><a href="#">Entrenamiento</a></li>
        <li class="btn btn-default"><a href="#">Gala</a></li>
        <li class="btn btn-default"><a href="#">Cooperativs</a></li>
        <li class="btn btn-default"><a href="#">Otros</a></li>
    </ul>
</div>

<div class="row">
    <section class="panel">
        <header class="panel-heading">
            <div class="panel-actions">
                <a href="#" class="fa fa-caret-down"></a>
                <a href="#" class="fa fa-times"></a>
            </div>
            <h2 class="panel-title">Todas las Misiones</h2>
        </header>
        <div class="panel-body">
            <table  class="table table-bordered table-striped mb-none" id="datatable-default">
                <thead>
                    <tr>
                        <th style="width: 10px">ID</th>
                        <th>Nombre</th>
                        <th>Tipo</th>
                        <th>Fecha</th>
                        <th>Campaña</th>
                        <th>Mapa</th>
                        <th>Estado</th>
                        <th>Autor</th>
                        <th>Reporte</th>
                    </tr>
                </thead>
                <tbody>
                {% for object in object_list %}
                    <tr>
                        <td>{{object.pk}}</td>
                        <td><a href="{{object.get_absolute_url}}">{{ object.nombre|truncatewords:4 }}</a></td>
                        <td>{{object.print_tipo}}</td>
                        <td>{{ object.fecha_finalizada }}</td>
                        <td><a href="{{ object.campana.get_absolute_url }}">{{ object.campana.nombre|truncatewords:4 }}</a></td>
                        <td>{{ object.mapa }}</td>
                        {% if object.estado == object.ESTADO_FINALIZADA %}
                            <td class="success">{{ object.estado }}</td>
                        {% elif object.estado == object.ESTADO_AGENDADA %}
                            <td class="primary">{{ object.estado }}</td>
                        {% elif object.estado == object.ESTADO_BORRADOR %}
                            <td class="warning">{{ object.estado }}</td>
                        {% elif object.estado == object.ESTADO_EDITANDO %}
                            <td class="warning">{{ object.estado }}</td>
                        {% elif object.estado == object.ESTADO_PENDIENTE %}
                            <td class="warning">{{ object.estado }}</td>
                        {% elif object.estado == object.ESTADO_PREPARADA %}
                            <td class="primary">{{ object.estado }}</td>
                        {% elif object.estado == object.ESTADO_RECHAZADA %}
                            <td class="danger">{{ object.estado }}</td>
                        {% else %}
                            <td class="danger">Oops!</td>
                        {% endif %}
                        <td>{{ object.autor }}</td>
                        {% if object.reporte %}
                            <td><a href="{{ object.reporte.url }}"><i class="fa fa-file" aria-hidden="true"></i> </a></td>
                        {% else %}
                            <td>Sin reporte.</td>
                        {% endif %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
</div>

<div class="row">
    <div class="col">
        <a class="btn btn-success" href="{% url 'stats:mision_create' %}">Crear Misión</a>
    </div>
</div>


{% endblock %}

{% block extra_scripts %}

<script>
        $(document).ready( function () {
            var table = $('#datatable-default').DataTable({
                "order": [[0, "desc"]],
            });

            $('ul').on( 'click', 'a', function () {
            table
                .columns(2)
                .search( $(this).text())
                .draw();
            });

            $('ul').on('click', 'a.all', function() {
              table
                .search('')
                .columns(2)
                .search('')
                .draw();
            });

        });
</script>
{% endblock %}